<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="JapanEase - A Beginner’s Guide to Japan.">
<meta name="author" content="Alijah Lucas Espinoza, Shekinah Marcel Puguon">
<link rel="icon" type="image/png" href="WEBSITEICON.png">

<link href="https://fonts.googleapis.com/css2?family=Zen+Old+Mincho:wght@400;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>

<title>JapanEase | Trip Planner</title>

<style>
:root{
  --autumn-red:#b63e2e;
  --autumn-orange:#d87c3f;
  --autumn-light:#f6e7d8;
  --autumn-dark:#3c2415;
  --autumn-brown:#8a5a44;
}

body{
  margin:0;
  font-family:'Zen Old Mincho',serif;
  background:var(--autumn-light);
  color:var(--autumn-dark);
  display:flex;
  flex-direction:column;
  min-height:100vh;
}

header{
  background:url('https://i.pinimg.com/1200x/d3/c7/1c/d3c71c951b70d5748e1a5187507393f4.jpg') center/cover no-repeat;
  text-align:center;
  padding:50px 20px;
  position:relative;
}

header img.logo{
  position:absolute;
  top:15px;
  right:15px;
  width:70px;
}

nav{
  background:var(--autumn-brown);
  text-align:center;
  padding:12px 0;
}

nav a{
  color:var(--autumn-light);
  text-decoration:none;
  font-weight:bold;
  margin:0 12px;
}

nav a:hover{color:var(--autumn-orange);}

main {
  display: flex;
  justify-content: center;
  align-items: flex-start;
  gap: 30px;
  padding: 60px 20px;
}

h1{text-align:center;}

.places-container{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
  gap:20px;
  margin-bottom:40px;
}

.place-card{
  background:#fff0e5;
  border:2px solid var(--autumn-brown);
  border-radius:12px;
  padding:20px;
  text-align:center;
  cursor:pointer;
  transition:0.2s;
}

.place-card:hover{
  transform:scale(1.05);
  box-shadow:0 4px 12px rgba(0,0,0,.2);
}

#map {
  width: 75vw;
  max-width: 1100px;
  height: 520px;
  border-radius: 18px;
  box-shadow: 0 8px 20px rgba(0,0,0,0.3);
}


.info{
  margin-top:15px;
  background:#fff8f0;
  padding:15px;
  border-radius:14px;
}

.modal{
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.6);
  justify-content:center;
  align-items:center;
}

.modal-content{
  background:var(--autumn-light);
  padding:30px;
  border-radius:12px;
  text-align:center;
}

.close-btn{
  margin-top:20px;
  padding:8px 16px;
  background:var(--autumn-orange);
  border:none;
  color:white;
  border-radius:8px;
  cursor:pointer;
}

footer{
  background:var(--autumn-brown);
  color:var(--autumn-light);
  text-align:center;
  padding:20px;
}
</style>
</head>

<body>

<header>
  <img src="images/WEBSITEICON.png" class="logo">
  <h1>JapanEase</h1>
  <h2>A Beginner’s Guide to Japan</h2>
</header>

<nav>
  <a href="A_home.html">Home</a>
  <a href="B_itinerary.html">Itinerary</a>
  <a href="C_foodguide.html">Food Guide</a>
  <a href="D_traveltips.html">Travel Tips</a>
  <a href="E_souvenirs.html">Souvenirs</a>
  <a href="F_aboutus.html">About Us</a>
  <a href="G_expenses.html">Expenses</a>
  <a href="H_budget.html">Budget Overview</a>
  <a href="I_tripmap.html">Trip Planner</a>
</nav>

<main>

<h1>Places You Want to Visit</h1>
<div class="places-container" id="placesContainer"></div>

<div id="map"></div>

<div class="info">
  <b>Instructions:</b>
  <ul>
    <li>Click the map to add a pin</li>
    <li>Drag pins to adjust locations</li>
    <li>Click a pin to add notes</li>
    <li>Broken lines show your route</li>
  </ul>
</div>

</main>

<div class="modal" id="modal">
  <div class="modal-content">
    <p id="placeName"></p>
    <button class="close-btn" onclick="closeModal()">Close</button>
  </div>
</div>

<footer>
  <p>© 2025 JapanEase. All Rights Reserved.</p>
</footer>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>
const savedData=JSON.parse(localStorage.getItem("tripPlanner"))||{}
const places=savedData.places?savedData.places.split(',').map(p=>p.trim()):[]
const container=document.getElementById("placesContainer")

places.forEach(p=>{
  const d=document.createElement("div")
  d.className="place-card"
  d.textContent=p
  d.onclick=()=>openModal(p)
  container.appendChild(d)
})

const modal=document.getElementById("modal")
const placeName=document.getElementById("placeName")

function openModal(p){placeName.textContent="Plan your visit: "+p;modal.style.display="flex"}
function closeModal(){modal.style.display="none"}

const map=L.map("map").setView([36.2048,138.2529],5)
L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png").addTo(map)

let data=JSON.parse(localStorage.getItem("routeData"))||[]
let markers=[],polyline=null

function sync(){
  data=markers.map(m=>{
    const p=m.getLatLng()
    return{lat:p.lat,lng:p.lng,note:m.getPopup().getContent()}
  })
  localStorage.setItem("routeData",JSON.stringify(data))
  if(polyline)map.removeLayer(polyline)
  if(markers.length>1){
    polyline=L.polyline(markers.map(m=>m.getLatLng()),{
      color:"#b63e2e",dashArray:"8,10",weight:3
    }).addTo(map)
  }
}

function addMarker(lat,lng,note=""){
  const m=L.marker([lat,lng],{draggable:true}).addTo(map)
  m.bindPopup(note||"Click to add note")
  m.on("click",()=>{const t=prompt("Location note:",m.getPopup().getContent());if(t!==null){m.bindPopup(t);sync()}})
  m.on("dragend",sync)
  markers.push(m)
  sync()
}

data.forEach(p=>addMarker(p.lat,p.lng,p.note))
map.on("click",e=>addMarker(e.latlng.lat,e.latlng.lng))
</script>

</body>
</html>
